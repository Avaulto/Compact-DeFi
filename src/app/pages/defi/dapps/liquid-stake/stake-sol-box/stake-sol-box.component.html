<div id="segmented-util" >
  <div id="segment-header" class="ion-text-uppercase">
    
      <span (click)="setUtil('stake')" [class.active]="segmentUtilTab == 'stake'">stake</span>
      <!-- <span *ngIf=" selectedProvider?.name?.toLowerCase() == 'solblaze' " (click)="setUtil('cls')" [class.active]="segmentUtilTab == 'cls'">custom validator stake</span> -->

      <span (click)="setUtil('unstake')" [class.active]="segmentUtilTab == 'unstake'">unstake</span>
  </div>


  <div [ngSwitch]="segmentUtilTab" id="liquid-stake-form" class="ion-padding-vertical">
      <form *ngSwitchCase="'stake'" [formGroup]="stakeForm">
          <app-label-layout [layoutConfig]="{title: 'SOL Amount', balance:solBalance, toolTip:'A â—Ž 0.0001 is reduced from maximum balance to prevent missing tx fee.'}">
          </app-label-layout>
          <ion-row id="stake-amount">
              <ion-input class="button-text" formControlName="stakeAmount" placeholder="Amount"></ion-input>
              <span class="heading-6" (click)="setMaxAmountSOL()">MAX</span>
          </ion-row>

          <app-label-layout [layoutConfig]="{title: 'You will receive'}">
        </app-label-layout>

        
          <ion-row id="recive-amount">
              <ion-input readonly [value]="((stakeForm.controls.stakeAmount.value || 0) / stakePoolStats?.assetRatio) | number : '1.2-3'">
              </ion-input>
              <span>
                  {{selectedProvider.ticker}}
              </span>
          </ion-row>

          <ng-container *ngIf="withCLS; else elseTemplate">
                <div id="cls-wrapper">

                    <app-stake-custom-validator (onValidatorSelect)="setValidator($event)"></app-stake-custom-validator>
                    <ion-button class="cls-btn" fill="clear" slot="start" (click)="removeValidatorControl()">
                        <div>
                            remove custom validator
                        </div>
                    </ion-button>
                </div>

            
          </ng-container>
          <ng-template #elseTemplate>
                <ion-button 
                *ngIf="selectedProvider?.name?.toLowerCase() == 'solblaze'"
                 class="cls-btn" fill="clear"
                 (click)="addValidatorControl()" 
                 tooltip="stake with custom validator will give you the benefit to support your favorite validator while join liquid staking pool">
                <div>
                    add custom validator
                </div>
                </ion-button>
          </ng-template>
          <ion-row class="ion-justify-content-center">
              <!-- <app-loader></app-loader> -->
              <ion-button (click)="liquidStake()"  [disabled]="formSubmitted || stakeForm.invalid" class="ion-text-capitalize">
                  deposit SOL
              </ion-button>
          </ion-row>
      </form>
      <form *ngSwitchCase="'unstake'">

        <app-label-layout [layoutConfig]="{title: selectedProvider.ticker + ' Amount', balance: stakePoolStats.userHoldings.staked_asset| number  : '1.2-3'}"></app-label-layout>


          <ion-row id="stake-amount" style="margin-bottom:8px;">
              <ion-input class="button-text" [ngModelOptions]="{standalone: true}" [(ngModel)]="unStakeAmount" placeholder="Amount"></ion-input>
              <span class="heading-6" (click)="setMaxAmountxSOL()">MAX</span>
          </ion-row>
          <app-label-layout [layoutConfig]="{title: 'You will receive', toolTip: selectedProvider?.name?.toLowerCase() == 'solblaze' ? 'you will receive SOL in a form of stake account, in order to unlock your SOL you need to unstake this account and wait till epoch end to fully acquire it' : ''}">
          </app-label-layout>

          <ion-row id="sol-recive-amount" style="margin-bottom:8px;">
              <ion-input readonly [value]="((unStakeAmount || 0 ) * stakePoolStats?.assetRatio) | number : '1.2-3'">
              </ion-input>
          </ion-row>
          <ion-row class="sub" style="margin-bottom:8px;">
              Unstake fee: from 0.3%
          </ion-row>
          <ion-row class="ion-justify-content-center" style="margin-bottom:8px;">
              <ion-button (click)="liquidUnstake()" [disabled]="!unStakeAmount"
                  class="ion-text-capitalize">
                  Withdraw SOL
              </ion-button>
            </ion-row>
            <span class="sub" *ngIf="selectedProvider?.name?.toLowerCase() == 'solblaze'" id="unstake-it">looking for Instantly unstake your SOL? Check <a target="_blank" href="https://www.unstake.it">unstake.it</a></span>

      </form>
  </div>
</div>